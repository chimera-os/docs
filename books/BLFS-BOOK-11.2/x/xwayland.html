<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      Xwayland-22.1.3
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL-NS Stylesheets Vsnapshot" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-11.2">
    <div class="navheader">
      <h4>
        Beyond Linux<sup>®</sup> From Scratch <span class=
        "phrase">(systemd</span> Edition) - Version 11.2
      </h4>
      <h3>
        Chapter&nbsp;24.&nbsp;Graphical Environments
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="xkeyboard-config.html" title=
          "XKeyboardConfig-2.36">Prev</a>
          <p>
            XKeyboardConfig-2.36
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="xorg-server.html" title=
          "Xorg-Server-21.1.4">Next</a>
          <p>
            Xorg-Server-21.1.4
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="installing.html" title=
          "Chapter&nbsp;24.&nbsp;Graphical Environments">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch  (systemd  Edition) - Version 11.2">Home</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <h1 class="sect1">
        <a id="xwayland" name="xwayland"></a>Xwayland-22.1.3
      </h1>
      <div class="package" lang="en" xml:lang="en">
        <h2 class="sect2">
          Introduction to Xwayland
        </h2>
        <p>
          The <span class="application">Xwayland</span> package is an Xorg
          server running on top of the wayland server. It has been separated
          from the main Xorg server package. It allows running X clients
          inside a wayland session.
        </p>
        <p>
          This package is known to build and work properly using an LFS-11.2
          platform.
        </p>
        <h3>
          Package Information
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Download (HTTP): <a class="ulink" href=
                "https://www.x.org/pub/individual/xserver/xwayland-22.1.3.tar.xz">
                https://www.x.org/pub/individual/xserver/xwayland-22.1.3.tar.xz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Download (FTP): <a class="ulink" href=
                "ftp://ftp.x.org/pub/individual/xserver/xwayland-22.1.3.tar.xz">
                ftp://ftp.x.org/pub/individual/xserver/xwayland-22.1.3.tar.xz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Download MD5 sum: 83849961283e8cea32be6740914822e5
              </p>
            </li>
            <li class="listitem">
              <p>
                Download size: 1.2 MB
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimated disk space required: 65 MB (add 355 MB for tests)
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimated build time: 0.3 SBU (with parallelism=4; add 1.0
                SBU for tests, not including clone time)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Xwayland Dependencies
        </h3>
        <h4>
          Required
        </h4>
        <p class="required">
          <a class="xref" href="libxcvt.html" title=
          "libxcvt-0.1.2">libxcvt-0.1.2</a>, <a class="xref" href=
          "../general/pixman.html" title="Pixman-0.40.0">Pixman-0.40.0</a>,
          <a class="xref" href="../general/wayland-protocols.html" title=
          "Wayland-Protocols-1.26">wayland-protocols-1.26</a>, and <a class=
          "xref" href="x7font.html" title="Xorg Fonts">Xorg Fonts</a> (only
          font-util)
        </p>
        <h4>
          Recommended
        </h4>
        <p class="recommended">
          <a class="xref" href="libepoxy.html" title=
          "libepoxy-1.5.10">libepoxy-1.5.10</a>, <a class="xref" href=
          "../basicnet/libtirpc.html" title=
          "libtirpc-1.3.3">libtirpc-1.3.3</a>, and <a class="xref" href=
          "mesa.html" title="Mesa-22.1.7">Mesa-22.1.7</a>
        </p>
        <h4>
          Optional
        </h4>
        <p class="optional">
          <a class="xref" href="../general/git.html" title=
          "Git-2.37.2">git-2.37.2</a> (to download packages needed for the
          tests), <a class="xref" href="../general/libgcrypt.html" title=
          "libgcrypt-1.10.1">libgcrypt-1.10.1</a>, <a class="xref" href=
          "../postlfs/nettle.html" title="Nettle-3.8.1">Nettle-3.8.1</a>,
          <a class="xref" href="../pst/xmlto.html" title=
          "xmlto-0.0.28">xmlto-0.0.28</a>, <a class="xref" href=
          "x7legacy.html" title="Xorg Legacy">Xorg Legacy Fonts</a> (only
          bdftopcf, for building fonts required for the tests), <a class=
          "ulink" href=
          "https://gitlab.freedesktop.org/xorg/test/rendercheck">rendercheck</a>
          (for tests), and <a class="ulink" href=
          "https://wayland.pages.freedesktop.org/weston/">weston</a> (for
          tests)
        </p>
        <p class="usernotes">
          User Notes: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/xwayland">https://wiki.linuxfromscratch.org/blfs/wiki/xwayland</a>
        </p>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <h2 class="sect2">
          Installation of Xwayland
        </h2>
        <p>
          Install <span class="application">xwayland</span> by running the
          following commands:
        </p>
        <pre class="userinput"><kbd class=
        "command">sed -i '/install_man/,$d' meson.build &amp;&amp;

mkdir build &amp;&amp;
cd    build &amp;&amp;

meson --prefix=$XORG_PREFIX         \
      -Dxkb_output_dir=/var/lib/xkb \
      ..                            &amp;&amp;
ninja</kbd></pre>
        <p>
          Building the test framework needs some work. First, <a class=
          "ulink" href=
          "https://wayland.pages.freedesktop.org/weston/">weston</a> brings
          in several dependencies, but the number can be reduced by disabling
          unneeded features. The <span class=
          "command"><strong>meson</strong></span> command for a stripped down
          build of <span class="application">weston</span> is shown in
          <a class="ulink" href=
          "https://gitlab.freedesktop.org/xorg/xserver/-/blob/xwayland-21.1/.gitlab-ci/debian-install.sh">
          Upstream continuous integration build</a>.
        </p>
        <p>
          Running the tests involves downloading two other frameworks, in
          addition to the mentioned optional dependencies:
        </p>
        <pre class="userinput"><kbd class="command">mkdir tools &amp;&amp;
pushd tools &amp;&amp;

git clone https://gitlab.freedesktop.org/mesa/piglit.git --depth 1 &amp;&amp;
cat &gt; piglit/piglit.conf &lt;&lt; EOF                                    &amp;&amp;
<code class="literal">[xts]
path=$(pwd)/xts
EOF</code>

git clone https://gitlab.freedesktop.org/xorg/test/xts --depth 1   &amp;&amp;

export DISPLAY=:22           &amp;&amp;
../hw/vfb/Xvfb $DISPLAY &amp;
VFB_PID=$!                   &amp;&amp;
cd xts                       &amp;&amp;
CFLAGS=-fcommon ./autogen.sh &amp;&amp;
make                         &amp;&amp;
kill $VFB_PID                &amp;&amp;
unset DISPLAY VFB_PID        &amp;&amp;
popd</kbd></pre>
        <p>
          Then the tests can be run with:
        </p>
        <pre class="userinput"><kbd class=
        "command">XTEST_DIR=$(pwd)/tools/xts PIGLIT_DIR=$(pwd)/tools/piglit ninja test</kbd></pre>
        <p>
          Now, as the <code class="systemitem">root</code> user:
        </p>
        <pre class="root"><kbd class="command">ninja install &amp;&amp;
mkdir -pv /etc/X11/xorg.conf.d</kbd></pre>
        <p>
          If <a class="xref" href="xorg-server.html" title=
          "Xorg-Server-21.1.4">Xorg-Server-21.1.4</a> is not installed and
          you do not plan to install it later, you can install <span class=
          "command"><strong>Xvfb</strong></span> from this package. As the
          <code class="systemitem">root</code> user:
        </p>
        <pre class="userinput"><kbd class=
        "command">install -vm755 hw/vfb/Xvfb /usr/bin</kbd></pre>
      </div>
      <div class="commands" lang="en" xml:lang="en">
        <h2 class="sect2">
          Command Explanations
        </h2>
        <p>
          <span class="command"><strong>sed -i '/install_man/,$d'
          meson.build</strong></span>: Prevents installing a manual page for
          <span class="command"><strong>Xserver</strong></span>, which is not
          part of this package.
        </p>
        <p>
          <span class="command"><strong>mkdir -pv
          /etc/X11/xorg.conf.d</strong></span>: This directory is needed to
          put configuration files for Xwayland. This command ensures that it
          exists, as some applications might use it without first creating
          it.
        </p>
      </div>
      <div class="content" lang="en" xml:lang="en">
        <h2 class="sect2">
          Contents
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Installed Program:</strong>
              <span class="segbody">Xwayland</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Library:</strong>
              <span class="segbody">None</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Directory:</strong>
              <span class="segbody">None</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Short Descriptions
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="Xwayland" name="Xwayland"></a><span class=
                    "term"><span class=
                    "command"><strong>Xwayland</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Allows X clients to run under wayland
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="xkeyboard-config.html" title=
          "XKeyboardConfig-2.36">Prev</a>
          <p>
            XKeyboardConfig-2.36
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="xorg-server.html" title=
          "Xorg-Server-21.1.4">Next</a>
          <p>
            Xorg-Server-21.1.4
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="installing.html" title=
          "Chapter&nbsp;24.&nbsp;Graphical Environments">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Beyond Linux® From Scratch  (systemd  Edition) - Version 11.2">Home</a>
        </li>
      </ul>
    </div>
  </body>
</html>
